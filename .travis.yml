language: java

before_install:
  - chmod +x gradlew install_deps.sh
  - ./install_deps.sh

install: ./gradlew setupCIWorkspace -S
script:
 - ./gradlew build -S
 - rm -f $HOME/.gradle/caches/modules-2/modules-2.lock

env:
  global:
    TERM=dumb

sudo: false

cache:
  directories:
    - ./libs
    - $HOME/.gradle/caches

deploy:
  provider: releases
  api-key: "GI0yeA9rWkvBcv+DcViPFLHNrbszCWV/jZKmKeJ6zFwzHxhcfWL58LAHuA1WIR/OSIF0Lfcqi/EmIwHaZx1BjSmI2P7Wbps3lW7nSPP9FEUQob3kQm0dLGookrp5C+a37SH7Zv4HvV2JlmYjFjo8dB4nC81Rs/uY0KQlwuinHDM="
  file: "./build/libs/AgriCraft-*.jar"
  file_glob: true
  skip_cleanup: true
  on:
    tags: true
    all_branches: true
